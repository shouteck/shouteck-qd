% ------------------------------------------------------------
% Technical Specification – Single-Stock Trading System (Phase 1)
% Target: NASDAQ stock trading via Webull (paper → live)
% Language: C++
% ------------------------------------------------------------

\documentclass[11pt]{article}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}

\title{Technical Specification \
Phase 1: Single-Stock Event-Driven Trading System}
\author{Quant Dev Learning Project}
\date{\today}

\begin{document}
\maketitle

\section{Purpose and Scope}

This document specifies the \textbf{current implemented architecture and behavior} of a minimal, production-oriented trading system designed for:

\begin{itemize}
\item Trading a \textbf{single NASDAQ-listed stock}
\item Deterministic event-driven execution
\item Paper trading with broker-style execution latency
\item Gradual transition toward live trading via \textbf{Webull}
\end{itemize}

The system prioritizes \textbf{correctness, causality, observability, and risk control} over performance or strategy sophistication.

\section{Design Principles}

\begin{itemize}
\item No lookahead bias
\item Separation of concerns
\item Explicit temporal ordering
\item Broker-realistic execution semantics
\item Deterministic replay
\item Incremental realism toward live trading
\end{itemize}

\section{High-Level Architecture}

\begin{verbatim}
Market Data (CSV)
↓
MarketData (filters invalid ticks)
↓
Strategy (price → signal)
↓
Execution Engine (signal → order)
↓
Paper Broker (1-tick latency)
↓
Portfolio (cash & position)
↓
Logger (audit trail)
\end{verbatim}

\section{Market Data Layer}

\subsection{MarketTick}

Each market event is represented as an immutable value object:

\begin{lstlisting}[language=C++]
struct MarketTick {
std::string timestamp; // "YYYY-MM-DD HH:MM:SS" (ET)
double price;
};
\end{lstlisting}

\subsection{Data Source}

Market data is loaded from CSV files with the format:

\begin{verbatim}
timestamp,price
2024-06-12 09:30:00,189.35
\end{verbatim}

The CSV file is loaded once at startup and replayed deterministically.

\subsection{Market Hours Filtering}

The \texttt{MarketData} component enforces market-session validity:

\begin{itemize}
\item Only regular US market hours are accepted: \textbf{09:30–16:00 ET}
\item Pre-market and after-hours ticks are discarded \emph{before} entering the system
\item Strategy, execution, and portfolio layers never see invalid ticks
\end{itemize}

\textbf{Assumptions:}

\begin{itemize}
\item Timestamps are already in US Eastern Time
\item Daylight Saving Time correctness is handled by the data source
\end{itemize}

\textbf{Note:} Exchange holidays and DST edge cases are intentionally out of scope for Phase 1.

\section{Strategy Layer}

The strategy consumes prices sequentially and emits a trading signal:

\begin{itemize}
\item Buy
\item Sell
\item Hold
\end{itemize}

\subsection{Properties}

\begin{itemize}
\item Stateless from the system perspective
\item Deterministic given price history
\item No direct access to portfolio state
\item No direct access to execution or broker logic
\end{itemize}

\section{Signal Semantics}

\begin{lstlisting}[language=C++]
enum class Signal {
Buy,
Sell,
Hold
};
\end{lstlisting}

A signal represents \textbf{intent only}. It does not imply execution, quantity, or fill certainty.

\section{Execution Engine}

\subsection{Responsibilities}

\begin{itemize}
\item Translate signals into executable orders
\item Enforce execution latency
\item Prevent overlapping or conflicting orders
\item Model a minimal paper broker
\end{itemize}

\subsection{Pending Orders}

\begin{lstlisting}[language=C++]
struct PendingOrder {
Signal side;
int quantity;
};
\end{lstlisting}

\begin{itemize}
\item Only one pending order may exist at any time
\item Quantity is fixed and simplified for Phase 1
\end{itemize}

\subsection{Execution Latency Model}

The system enforces a \textbf{1-tick execution latency}:

\begin{quote}
A trading decision made at tick $t$ may only be filled at tick $t+1$.
\end{quote}

This ensures:

\begin{itemize}
\item No same-tick execution
\item No instantaneous fills
\item Correct causal ordering
\item Realistic paper-broker behavior
\end{itemize}

\section{Portfolio}

\subsection{State Variables}

\begin{itemize}
\item Cash balance
\item Share position
\item Initial capital
\end{itemize}

\subsection{Computed Quantities}

\begin{itemize}
\item Equity: $cash + position \times price$
\item PnL: $equity - initial_cash$
\end{itemize}

\subsection{Simplifications}

\begin{itemize}
\item No transaction costs
\item No slippage
\item No partial fills
\item No leverage or margin
\end{itemize}

\section{Main Event Loop}

For each valid market tick:

\begin{enumerate}
\item Fill any pending orders from the previous tick
\item Apply fills to the portfolio
\item Generate a trading signal from the strategy
\item Submit the signal to the execution engine
\item Log full system state
\end{enumerate}

This ordering strictly enforces temporal causality.

\section{Logging and Observability}

The system produces a structured CSV log capturing:

\begin{itemize}
\item Timestamp and price
\item Cash balance and position
\item Equity and cumulative PnL
\item Execution state (pending order flag)
\end{itemize}

Logging is synchronous, deterministic, and intended for audit, debugging, and analysis.

\section{Known Limitations}

\begin{itemize}
\item No timezone-aware timestamps
\item No exchange holiday calendar
\item No broker rejects or cancels
\item No asynchronous execution
\item Single-instrument only
\end{itemize}

These limitations are intentional and reflect the Phase 1 learning scope.

\section{Planned Extensions}

\begin{itemize}
\item Formal order lifecycle (Submitted / Pending / Filled / Rejected)
\item Transaction costs and slippage
\item Exchange calendar and DST correctness
\item Webull API adapter (paper → live)
\item Live trading safety checks
\end{itemize}

\section{Conclusion}

This system represents a \textbf{correct, observable, and causally sound foundation} for real-world algorithmic trading.

Each component is designed to evolve incrementally toward live deployment without sacrificing correctness.

\end{document}
